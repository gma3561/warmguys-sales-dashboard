(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{4004:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/geukjin",function(){return a(5002)}])},4122:function(e,t,a){"use strict";a.d(t,{Z:function(){return Navigation}});var s=a(5893);a(7294);var r=a(1664),l=a.n(r),n=a(1163);function Navigation(){let e=(0,n.useRouter)();return(0,s.jsx)("nav",{className:"bg-blue-600 text-white p-4",children:(0,s.jsxs)("div",{className:"container mx-auto flex justify-between items-center",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)(l(),{href:"/",children:(0,s.jsx)("span",{className:"text-xl font-bold cursor-pointer",children:"계열사 매출 대시보드"})})}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)(l(),{href:"/",children:(0,s.jsx)("span",{className:"cursor-pointer px-3 py-2 rounded ".concat("/"===e.pathname?"bg-blue-700":"hover:bg-blue-700"),children:"대시보드"})}),(0,s.jsx)(l(),{href:"/admin",children:(0,s.jsx)("span",{className:"cursor-pointer px-3 py-2 rounded ".concat("/admin"===e.pathname?"bg-blue-700":"hover:bg-blue-700"),children:"관리자"})})]})]})})}},3946:function(e,t,a){"use strict";a.d(t,{$7:function(){return getAffiliateConfig},OQ:function(){return r},Qt:function(){return calculateKPIs},fD:function(){return getSalesData}});var s=a(8590);let r=(0,s.eI)("https://ooqexropurnslqmcbjqk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9vcWV4cm9wdXJuc2xxbWNianFrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc0NzQyMDUsImV4cCI6MjA2MzA1MDIwNX0.yXVabtxZwX3QFF6xnjmj5VI2Lrp_7fZ3HvS5dCalbuA"),l={ALL:null,MRS:"mrs_sales",WARMGUYS:"warmguys_sales",APGUJEONG:"apgujeong_apgujung_sales",GAROSU:"garosu_sales",GEUKJIN:"geukjin_sales"};async function getSalesData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MRS",a=new Date,s=new Date;if(s.setDate(a.getDate()-e),"ALL"===t){let{data:e,error:t}=await r.from("all_affiliates_view").select("*").gte("date",s.toISOString().split("T")[0]).order("date",{ascending:!0});return t?(console.error("Error fetching all affiliates data:",t),[]):e}{let e=l[t];if(!e)return console.error("Invalid affiliate key:",t),[];let{data:a,error:n}=await r.from(e).select("*").gte("date",s.toISOString().split("T")[0]).order("date",{ascending:!0});return n?(console.error("Error fetching ".concat(e," data:"),n),[]):a}}async function getAffiliateConfig(){let{data:e,error:t}=await r.from("affiliate_config").select("*").eq("is_active",!0).order("affiliate_name");return t?(console.error("Error fetching affiliate config:",t),[]):e}function calculateKPIs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MRS";if(!e||0===e.length)return{totalSales:0,averageDailySales:0,totalOrders:0,refundRate:0,growthRate:0};let a=e.reduce((e,t)=>e+(parseFloat(t.total_sales)||0),0),s=a/e.length,r=e.reduce((e,a)=>"APGUJEONG"===t?e+(parseInt(a.customer_count)||0):e+(parseInt(a.order_count)||0),0),l=e.reduce((e,a)=>"GEUKJIN"===t?0:e+(parseFloat(a.refund_amount)||0),0),n=0;if(e.length>=2){let t=e[e.length-1],a=e[e.length-2],s=parseFloat(t.total_sales)||0,r=parseFloat(a.total_sales)||0;r>0&&(n=(s-r)/r*100)}return{totalSales:a,averageDailySales:s,totalOrders:r,refundRate:a>0?l/a*100:0,growthRate:n}}},3850:function(e,t,a){"use strict";function formatNumber(e){return null==e?"0":new Intl.NumberFormat("ko-KR").format(Math.round(e))}function formatPercent(e){return null==e?"0%":"".concat(e.toFixed(1),"%")}a.d(t,{T3:function(){return formatPercent},uf:function(){return formatNumber}})},5002:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return b}});var s=a(5893),r=a(7294),l=a(9008),n=a.n(l),i=a(1163),c=a(3706),o=a(3946),d=a(4122),x=a(3850),h=a(9009),m=a(8687),u=a(4195),g=a(3023),p=a(5358),f=a(6050),j=a(3558),N=a(6880),w=a(4831),y=a(483),components_GeukjinDashboard=e=>{let{salesData:t,kpis:a}=e,[l,n]=(0,r.useState)([]);(0,r.useEffect)(()=>{if(!t||0===t.length)return;let e=t.map(e=>({date:e.date,gasolineSales:parseFloat(e.gasoline_sales||0),dieselSales:parseFloat(e.diesel_sales||0),keroseneSales:parseFloat(e.kerosene_sales||0),freightSales:parseFloat(e.freight_sales||0),totalSales:parseFloat(e.total_sales||0),totalCost:parseFloat(e.total_cost||0),totalMargin:parseFloat(e.total_margin||0),growthRate:parseFloat(e.growth_rate||0)}));n(e)},[t]);let i=l.slice(-30),c=l.reduce((e,t)=>(e.gasoline+=t.gasolineSales,e.diesel+=t.dieselSales,e.kerosene+=t.keroseneSales,e.freight+=t.freightSales,e),{gasoline:0,diesel:0,kerosene:0,freight:0}),o=[{name:"무연휘발유",value:c.gasoline},{name:"경유",value:c.diesel},{name:"등유",value:c.kerosene},{name:"운임",value:c.freight}];return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"총매출"}),(0,s.jsxs)("p",{className:"text-2xl font-bold",children:[(0,x.uf)(a.totalSales||0),"원"]}),(0,s.jsxs)("p",{className:"text-sm ".concat(a.growthRate>=0?"text-green-500":"text-red-500"),children:[a.growthRate>=0?"↑":"↓"," ",Math.abs(a.growthRate||0).toFixed(1),"%"]})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"휘발유 매출"}),(0,s.jsxs)("p",{className:"text-2xl font-bold",children:[(0,x.uf)(c.gasoline),"원"]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["전체의 ",(0,x.T3)(c.gasoline/a.totalSales*100||0)]})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"경유 매출"}),(0,s.jsxs)("p",{className:"text-2xl font-bold",children:[(0,x.uf)(c.diesel),"원"]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["전체의 ",(0,x.T3)(c.diesel/a.totalSales*100||0)]})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"평균 마진율"}),(0,s.jsxs)("p",{className:"text-2xl font-bold",children:[l.reduce((e,t)=>e+t.totalMargin/t.totalSales*100,0)/l.length||0,"%"]})]})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow overflow-x-auto",children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-3",children:"일별 매출 상세"}),(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"날짜"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"휘발유"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"경유"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"등유"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"운임"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"원가"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"마진"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"마진율"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"총매출"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:l.slice().reverse().map((e,t)=>(0,s.jsxs)("tr",{className:t%2==0?"bg-gray-50":"bg-white",children:[(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:e.date}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-right",children:(0,x.uf)(e.gasolineSales)}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-right",children:(0,x.uf)(e.dieselSales)}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-right",children:(0,x.uf)(e.keroseneSales)}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-right",children:(0,x.uf)(e.freightSales)}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-right",children:(0,x.uf)(e.totalCost)}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-right",children:(0,x.uf)(e.totalMargin)}),(0,s.jsxs)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-right",children:[e.totalSales>0?(e.totalMargin/e.totalSales*100).toFixed(1):"0","%"]}),(0,s.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-right font-bold",children:(0,x.uf)(e.totalSales)})]},t))})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-3",children:"총매출 추이"}),(0,s.jsx)("div",{className:"h-64",children:(0,s.jsx)(h.h,{width:"100%",height:"100%",children:(0,s.jsxs)(m.w,{data:i,margin:{top:5,right:30,left:20,bottom:5},children:[(0,s.jsx)(u.q,{strokeDasharray:"3 3"}),(0,s.jsx)(g.K,{dataKey:"date"}),(0,s.jsx)(p.B,{}),(0,s.jsx)(f.u,{formatter:e=>["".concat((0,x.uf)(e),"원"),"매출"],labelFormatter:e=>"날짜: ".concat(e)}),(0,s.jsx)(j.D,{}),(0,s.jsx)(N.x,{type:"monotone",dataKey:"totalSales",name:"총매출",stroke:"#8884d8",activeDot:{r:8}})]})})})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-3",children:"연료별 매출 분포"}),(0,s.jsx)("div",{className:"h-64",children:(0,s.jsx)(h.h,{width:"100%",height:"100%",children:(0,s.jsxs)(w.v,{data:o,margin:{top:5,right:30,left:20,bottom:5},children:[(0,s.jsx)(u.q,{strokeDasharray:"3 3"}),(0,s.jsx)(g.K,{dataKey:"name"}),(0,s.jsx)(p.B,{}),(0,s.jsx)(f.u,{formatter:e=>["".concat((0,x.uf)(e),"원"),"매출"]}),(0,s.jsx)(j.D,{}),(0,s.jsx)(y.$,{dataKey:"value",name:"매출액",fill:"#82ca9d"})]})})})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-3",children:"마진율 추이"}),(0,s.jsx)("div",{className:"h-64",children:(0,s.jsx)(h.h,{width:"100%",height:"100%",children:(0,s.jsxs)(m.w,{data:i.map(e=>({...e,marginRate:e.totalSales>0?e.totalMargin/e.totalSales*100:0})),margin:{top:5,right:30,left:20,bottom:5},children:[(0,s.jsx)(u.q,{strokeDasharray:"3 3"}),(0,s.jsx)(g.K,{dataKey:"date"}),(0,s.jsx)(p.B,{domain:[0,"dataMax + 5"]}),(0,s.jsx)(f.u,{formatter:e=>["".concat(e.toFixed(1),"%"),"마진율"]}),(0,s.jsx)(j.D,{}),(0,s.jsx)(N.x,{type:"monotone",dataKey:"marginRate",name:"마진율",stroke:"#ff7300",activeDot:{r:8}})]})})})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-3",children:"연료별 일간 추이"}),(0,s.jsx)("div",{className:"h-64",children:(0,s.jsx)(h.h,{width:"100%",height:"100%",children:(0,s.jsxs)(m.w,{data:i,margin:{top:5,right:30,left:20,bottom:5},children:[(0,s.jsx)(u.q,{strokeDasharray:"3 3"}),(0,s.jsx)(g.K,{dataKey:"date"}),(0,s.jsx)(p.B,{}),(0,s.jsx)(f.u,{formatter:e=>["".concat((0,x.uf)(e),"원"),"매출"]}),(0,s.jsx)(j.D,{}),(0,s.jsx)(N.x,{type:"monotone",dataKey:"gasolineSales",name:"휘발유",stroke:"#8884d8"}),(0,s.jsx)(N.x,{type:"monotone",dataKey:"dieselSales",name:"경유",stroke:"#82ca9d"}),(0,s.jsx)(N.x,{type:"monotone",dataKey:"keroseneSales",name:"등유",stroke:"#ff7300"})]})})})]})]})]})},b=(0,c.QO)(function(){let[e,t]=(0,r.useState)(!0),[a,l]=(0,r.useState)([]),[c,x]=(0,r.useState)({}),[h,m]=(0,r.useState)(30);(0,i.useRouter)(),(0,r.useEffect)(()=>{(async function(){t(!0);try{let e=await (0,o.fD)(h,"GEUKJIN");l(e);let t=(0,o.Qt)(e,"GEUKJIN");x(t)}catch(e){console.error("Error fetching GEUKJIN data:",e)}finally{t(!1)}})()},[h]);let handlePeriodChange=e=>{m(e)};return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,s.jsxs)(n(),{children:[(0,s.jsx)("title",{children:"웜가이즈 - 극진이앤지 대시보드"}),(0,s.jsx)("meta",{name:"description",content:"웜가이즈 극진이앤지 매출 대시보드"})]}),(0,s.jsx)(d.Z,{}),(0,s.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"극진이앤지 대시보드"}),(0,s.jsx)("div",{className:"flex justify-end mb-4",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>handlePeriodChange(7),className:"px-4 py-2 rounded ".concat(7===h?"bg-blue-500 text-white":"bg-gray-200"),children:"7일"}),(0,s.jsx)("button",{onClick:()=>handlePeriodChange(30),className:"px-4 py-2 rounded ".concat(30===h?"bg-blue-500 text-white":"bg-gray-200"),children:"30일"}),(0,s.jsx)("button",{onClick:()=>handlePeriodChange(90),className:"px-4 py-2 rounded ".concat(90===h?"bg-blue-500 text-white":"bg-gray-200"),children:"90일"})]})}),e?(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):(0,s.jsx)(components_GeukjinDashboard,{salesData:a,kpis:c})]})]})})}},function(e){e.O(0,[227,664,394,774,888,179],function(){return e(e.s=4004)}),_N_E=e.O()}]);