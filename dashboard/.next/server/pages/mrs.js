"use strict";(()=>{var e={};e.id=114,e.ids=[114,888,660],e.modules={5470:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{config:()=>g,default:()=>h,getServerSideProps:()=>m,getStaticPaths:()=>u,getStaticProps:()=>p,reportWebVitals:()=>f,routeModule:()=>w,unstable_getServerProps:()=>b,unstable_getServerSideProps:()=>N,unstable_getStaticParams:()=>_,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>j});var l=a(7093),r=a(5244),n=a(1323),c=a(9209),i=a.n(c),o=a(1065),d=a(3331),x=e([d]);d=(x.then?(await x)():x)[0];let h=(0,n.l)(d,"default"),p=(0,n.l)(d,"getStaticProps"),u=(0,n.l)(d,"getStaticPaths"),m=(0,n.l)(d,"getServerSideProps"),g=(0,n.l)(d,"config"),f=(0,n.l)(d,"reportWebVitals"),j=(0,n.l)(d,"unstable_getStaticProps"),y=(0,n.l)(d,"unstable_getStaticPaths"),_=(0,n.l)(d,"unstable_getStaticParams"),b=(0,n.l)(d,"unstable_getServerProps"),N=(0,n.l)(d,"unstable_getServerSideProps"),w=new l.PagesRouteModule({definition:{kind:r.x.PAGES,page:"/mrs",pathname:"/mrs",bundlePath:"",filename:""},components:{App:o.default,Document:i()},userland:d});s()}catch(e){s(e)}})},8804:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var l=a(997),r=a(6689),n=a(3850),c=a(8094),i=a(4034),o=e([c,i]);[c,i]=o.then?(await o)():o;let __WEBPACK_DEFAULT_EXPORT__=({salesData:e,kpis:t})=>{let[a,s]=(0,r.useState)({today:{},yesterday:{}}),[o,d]=(0,r.useState)({thisWeek:{},lastWeek:{}}),[x,h]=(0,r.useState)({thisMonth:{},lastMonth:{}});(0,r.useEffect)(()=>{if(!e||0===e.length)return;let t=new Date,a=new Date(t);a.setDate(a.getDate()-1);let formatDate=e=>e.toISOString().split("T")[0],l=e.find(e=>e.date===formatDate(t))||{},r=e.find(e=>e.date===formatDate(a))||{};s({today:l,yesterday:r});let n=new Date(t);n.setDate(t.getDate()-t.getDay());let c=new Date(n);c.setDate(c.getDate()-7);let i=new Date(n);i.setDate(n.getDate()+6);let o=new Date(c);o.setDate(c.getDate()+6);let x=e.filter(e=>{let t=new Date(e.date);return t>=n&&t<=i}),p=e.filter(e=>{let t=new Date(e.date);return t>=c&&t<=o}),u=calculateTotal(x),m=calculateTotal(p);d({thisWeek:u,lastWeek:m});let g=new Date(t.getFullYear(),t.getMonth(),1),f=new Date(t.getFullYear(),t.getMonth()-1,1),j=new Date(t.getFullYear(),t.getMonth(),0),y=e.filter(e=>{let a=new Date(e.date);return a>=g&&a<=t}),_=e.filter(e=>{let t=new Date(e.date);return t>=f&&t<=j}),b=calculateTotal(y),N=calculateTotal(_);h({thisMonth:b,lastMonth:N})},[e]);let calculateTotal=e=>e.reduce((e,t)=>(e.total_sales=(e.total_sales||0)+parseFloat(t.total_sales||0),e.coupang_rocket=(e.coupang_rocket||0)+parseFloat(t.coupang_rocket||0),e.smart_store=(e.smart_store||0)+parseFloat(t.smart_store||0),e.coupang_wing=(e.coupang_wing||0)+parseFloat(t.coupang_wing||0),e.other_online=(e.other_online||0)+parseFloat(t.other_online||0),e.wholesale=(e.wholesale||0)+parseFloat(t.wholesale||0),e.export=(e.export||0)+parseFloat(t.export||0),e.refund_amount=(e.refund_amount||0)+parseFloat(t.refund_amount||0),e),{}),calculateDiff=(e,t,a)=>{let s=parseFloat(e[a]||0),l=parseFloat(t[a]||0);if(0===l)return{value:0,percent:0};let r=s-l;return{value:r,percent:r/l*100}},p=e.length>0?[{name:"쿠팡로켓",value:e.reduce((e,t)=>e+parseFloat(t.coupang_rocket||0),0)},{name:"스마트스토어",value:e.reduce((e,t)=>e+parseFloat(t.smart_store||0),0)},{name:"쿠팡윙",value:e.reduce((e,t)=>e+parseFloat(t.coupang_wing||0),0)},{name:"기타온라인",value:e.reduce((e,t)=>e+parseFloat(t.other_online||0),0)},{name:"도매",value:e.reduce((e,t)=>e+parseFloat(t.wholesale||0),0)},{name:"수출",value:e.reduce((e,t)=>e+parseFloat(t.export||0),0)}].filter(e=>e.value>0):[];return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,l.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"총매출"}),(0,l.jsxs)("p",{className:"text-2xl font-bold",children:[(0,n.uf)(t.totalSales||0),"원"]}),(0,l.jsxs)("p",{className:`text-sm ${t.growthRate>=0?"text-green-500":"text-red-500"}`,children:[t.growthRate>=0?"↑":"↓"," ",Math.abs(t.growthRate||0).toFixed(1),"%"]})]}),(0,l.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"쿠팡로켓"}),(0,l.jsxs)("p",{className:"text-2xl font-bold",children:[(0,n.uf)(e.reduce((e,t)=>e+parseFloat(t.coupang_rocket||0),0)),"원"]}),(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:["전체의 ",(e.reduce((e,t)=>e+parseFloat(t.coupang_rocket||0),0)/t.totalSales*100||0).toFixed(1),"%"]})]}),(0,l.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"스마트스토어"}),(0,l.jsxs)("p",{className:"text-2xl font-bold",children:[(0,n.uf)(e.reduce((e,t)=>e+parseFloat(t.smart_store||0),0)),"원"]}),(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:["전체의 ",(e.reduce((e,t)=>e+parseFloat(t.smart_store||0),0)/t.totalSales*100||0).toFixed(1),"%"]})]}),(0,l.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"환불액"}),(0,l.jsxs)("p",{className:"text-2xl font-bold text-red-500",children:[(0,n.uf)(e.reduce((e,t)=>e+parseFloat(t.refund_amount||0),0)),"원"]}),(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:["환불률 ",t.refundRate?.toFixed(1)||0,"%"]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[l.jsx("h3",{className:"text-lg font-medium mb-3",children:"일별 채널 비교"}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-500",children:"채널"}),(0,l.jsxs)("div",{className:"flex space-x-4",children:[l.jsx("span",{className:"text-gray-500",children:"오늘"}),l.jsx("span",{className:"text-gray-500",children:"어제"}),l.jsx("span",{className:"text-gray-500",children:"증감"})]})]}),["coupang_rocket","smart_store","coupang_wing","other_online","wholesale","export"].map(e=>{let t=calculateDiff(a.today,a.yesterday,e);return(0,l.jsxs)("div",{className:"flex justify-between",children:[l.jsx("span",{children:{coupang_rocket:"쿠팡로켓",smart_store:"스마트스토어",coupang_wing:"쿠팡윙",other_online:"기타온라인",wholesale:"도매",export:"수출"}[e]}),(0,l.jsxs)("div",{className:"flex space-x-4",children:[l.jsx("span",{children:(0,n.uf)(a.today[e]||0)}),l.jsx("span",{children:(0,n.uf)(a.yesterday[e]||0)}),(0,l.jsxs)("span",{className:t.percent>=0?"text-green-500":"text-red-500",children:[t.percent>=0?"+":"",t.percent.toFixed(1),"%"]})]})]},e)}),(0,l.jsxs)("div",{className:"flex justify-between font-bold mt-2 pt-2 border-t",children:[l.jsx("span",{children:"총계"}),(0,l.jsxs)("div",{className:"flex space-x-4",children:[l.jsx("span",{children:(0,n.uf)(a.today.total_sales||0)}),l.jsx("span",{children:(0,n.uf)(a.yesterday.total_sales||0)}),(0,l.jsxs)("span",{className:calculateDiff(a.today,a.yesterday,"total_sales").percent>=0?"text-green-500":"text-red-500",children:[calculateDiff(a.today,a.yesterday,"total_sales").percent>=0?"+":"",calculateDiff(a.today,a.yesterday,"total_sales").percent.toFixed(1),"%"]})]})]})]})]}),(0,l.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[l.jsx("h3",{className:"text-lg font-medium mb-3",children:"주별 채널 비교"}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-500",children:"채널"}),(0,l.jsxs)("div",{className:"flex space-x-4",children:[l.jsx("span",{className:"text-gray-500",children:"이번주"}),l.jsx("span",{className:"text-gray-500",children:"지난주"}),l.jsx("span",{className:"text-gray-500",children:"증감"})]})]}),["coupang_rocket","smart_store","coupang_wing","other_online","wholesale","export"].map(e=>{let t=calculateDiff(o.thisWeek,o.lastWeek,e);return(0,l.jsxs)("div",{className:"flex justify-between",children:[l.jsx("span",{children:{coupang_rocket:"쿠팡로켓",smart_store:"스마트스토어",coupang_wing:"쿠팡윙",other_online:"기타온라인",wholesale:"도매",export:"수출"}[e]}),(0,l.jsxs)("div",{className:"flex space-x-4",children:[l.jsx("span",{children:(0,n.uf)(o.thisWeek[e]||0)}),l.jsx("span",{children:(0,n.uf)(o.lastWeek[e]||0)}),(0,l.jsxs)("span",{className:t.percent>=0?"text-green-500":"text-red-500",children:[t.percent>=0?"+":"",t.percent.toFixed(1),"%"]})]})]},e)}),(0,l.jsxs)("div",{className:"flex justify-between font-bold mt-2 pt-2 border-t",children:[l.jsx("span",{children:"총계"}),(0,l.jsxs)("div",{className:"flex space-x-4",children:[l.jsx("span",{children:(0,n.uf)(o.thisWeek.total_sales||0)}),l.jsx("span",{children:(0,n.uf)(o.lastWeek.total_sales||0)}),(0,l.jsxs)("span",{className:calculateDiff(o.thisWeek,o.lastWeek,"total_sales").percent>=0?"text-green-500":"text-red-500",children:[calculateDiff(o.thisWeek,o.lastWeek,"total_sales").percent>=0?"+":"",calculateDiff(o.thisWeek,o.lastWeek,"total_sales").percent.toFixed(1),"%"]})]})]})]})]}),(0,l.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[l.jsx("h3",{className:"text-lg font-medium mb-3",children:"월별 채널 비교"}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-500",children:"채널"}),(0,l.jsxs)("div",{className:"flex space-x-4",children:[l.jsx("span",{className:"text-gray-500",children:"이번달"}),l.jsx("span",{className:"text-gray-500",children:"지난달"}),l.jsx("span",{className:"text-gray-500",children:"증감"})]})]}),["coupang_rocket","smart_store","coupang_wing","other_online","wholesale","export"].map(e=>{let t=calculateDiff(x.thisMonth,x.lastMonth,e);return(0,l.jsxs)("div",{className:"flex justify-between",children:[l.jsx("span",{children:{coupang_rocket:"쿠팡로켓",smart_store:"스마트스토어",coupang_wing:"쿠팡윙",other_online:"기타온라인",wholesale:"도매",export:"수출"}[e]}),(0,l.jsxs)("div",{className:"flex space-x-4",children:[l.jsx("span",{children:(0,n.uf)(x.thisMonth[e]||0)}),l.jsx("span",{children:(0,n.uf)(x.lastMonth[e]||0)}),(0,l.jsxs)("span",{className:t.percent>=0?"text-green-500":"text-red-500",children:[t.percent>=0?"+":"",t.percent.toFixed(1),"%"]})]})]},e)}),(0,l.jsxs)("div",{className:"flex justify-between font-bold mt-2 pt-2 border-t",children:[l.jsx("span",{children:"총계"}),(0,l.jsxs)("div",{className:"flex space-x-4",children:[l.jsx("span",{children:(0,n.uf)(x.thisMonth.total_sales||0)}),l.jsx("span",{children:(0,n.uf)(x.lastMonth.total_sales||0)}),(0,l.jsxs)("span",{className:calculateDiff(x.thisMonth,x.lastMonth,"total_sales").percent>=0?"text-green-500":"text-red-500",children:[calculateDiff(x.thisMonth,x.lastMonth,"total_sales").percent>=0?"+":"",calculateDiff(x.thisMonth,x.lastMonth,"total_sales").percent.toFixed(1),"%"]})]})]})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[l.jsx("h3",{className:"text-lg font-medium mb-3",children:"채널별 매출 추이"}),l.jsx(c.Z,{salesData:e})]}),(0,l.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[l.jsx("h3",{className:"text-lg font-medium mb-3",children:"채널별 비율"}),l.jsx("div",{className:"h-64",children:l.jsx(i.Z,{channelData:p})})]})]})]})};s()}catch(e){s(e)}})},4034:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{Z:()=>SalesByChannelChart});var l=a(997),r=a(2189),n=a(3767),c=e([r,n]);function SalesByChannelChart({data:e}){if(!e||0===e.length)return l.jsx("div",{className:"flex items-center justify-center h-64 text-gray-500",children:"데이터가 없습니다"});let t=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4","#84CC16","#F97316"],a={labels:e.map(e=>e.name),datasets:[{data:e.map(e=>e.value),backgroundColor:t.slice(0,e.length),borderColor:t.slice(0,e.length).map(e=>e),borderWidth:2,hoverOffset:4}]};return l.jsx("div",{className:"h-64",children:l.jsx(r.Doughnut,{data:a,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0,pointStyle:"circle"}},tooltip:{callbacks:{label:function(e){let t=e.label||"",a=e.parsed,s=e.dataset.data.reduce((e,t)=>e+t,0),l=(a/s*100).toFixed(1);return`${t}: ${new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW"}).format(a)} (${l}%)`}}}},cutout:"50%"}})})}[r,n]=c.then?(await c)():c,n.Chart.register(n.ArcElement,n.Tooltip,n.Legend),s()}catch(e){s(e)}})},8094:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{Z:()=>SalesTrendChart});var l=a(997),r=a(2189),n=a(3767),c=e([r,n]);function SalesTrendChart({data:e,affiliateKey:t}){if(!e||0===e.length)return l.jsx("div",{className:"flex items-center justify-center h-64 text-gray-500",children:"데이터가 없습니다"});let a={labels:e.map(e=>{let t=new Date(e.date);return`${t.getMonth()+1}/${t.getDate()}`}),datasets:[{label:"총 매출",data:e.map(e=>parseFloat(e.total_sales)||0),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",borderWidth:2,fill:!0,tension:.4}]};return l.jsx("div",{className:"h-64",children:l.jsx(r.Line,{data:a,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{mode:"index",intersect:!1,callbacks:{label:function(e){let t=e.parsed.y;return`총 매출: ${new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW"}).format(t)}`}}}},scales:{x:{display:!0,title:{display:!0,text:"날짜"},grid:{display:!1}},y:{display:!0,title:{display:!0,text:"매출 (원)"},ticks:{callback:function(e){return new Intl.NumberFormat("ko-KR",{notation:"compact",compactDisplay:"short"}).format(e)}}}},interaction:{mode:"nearest",axis:"x",intersect:!1},elements:{point:{radius:4,hoverRadius:6}}}})})}[r,n]=c.then?(await c)():c,n.Chart.register(n.CategoryScale,n.LinearScale,n.PointElement,n.LineElement,n.Title,n.Tooltip,n.Legend),s()}catch(e){s(e)}})},3331:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{default:()=>u});var l=a(997),r=a(6689),n=a(968),c=a.n(n),i=a(1163),o=a(3706),d=a(3946),x=a(4122),h=a(8804),p=e([h]);h=(p.then?(await p)():p)[0];let u=(0,o.withAuth)(function(){let[e,t]=(0,r.useState)(!0),[a,s]=(0,r.useState)([]),[n,o]=(0,r.useState)({}),[p,u]=(0,r.useState)(30);(0,i.useRouter)(),(0,r.useEffect)(()=>{(async function(){t(!0);try{let e=await (0,d.fD)(p,"MRS");s(e);let t=(0,d.Qt)(e,"MRS");o(t)}catch(e){console.error("Error fetching MRS data:",e)}finally{t(!1)}})()},[p]);let handlePeriodChange=e=>{u(e)};return(0,l.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,l.jsxs)(c(),{children:[l.jsx("title",{children:"웜가이즈 - MRS 대시보드"}),l.jsx("meta",{name:"description",content:"웜가이즈 MRS 매출 대시보드"})]}),l.jsx(x.Z,{}),(0,l.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[l.jsx("h1",{className:"text-3xl font-bold mb-6",children:"MRS 대시보드"}),l.jsx("div",{className:"flex justify-end mb-4",children:(0,l.jsxs)("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>handlePeriodChange(7),className:`px-4 py-2 rounded ${7===p?"bg-blue-500 text-white":"bg-gray-200"}`,children:"7일"}),l.jsx("button",{onClick:()=>handlePeriodChange(30),className:`px-4 py-2 rounded ${30===p?"bg-blue-500 text-white":"bg-gray-200"}`,children:"30일"}),l.jsx("button",{onClick:()=>handlePeriodChange(90),className:`px-4 py-2 rounded ${90===p?"bg-blue-500 text-white":"bg-gray-200"}`,children:"90일"})]})}),e?l.jsx("div",{className:"flex justify-center items-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):l.jsx(h.Z,{salesData:a,kpis:n})]})]})});s()}catch(e){s(e)}})},2885:e=>{e.exports=require("@supabase/supabase-js")},6924:e=>{e.exports=require("date-fns/endOfMonth")},3864:e=>{e.exports=require("date-fns/endOfWeek")},4384:e=>{e.exports=require("date-fns/format")},5564:e=>{e.exports=require("date-fns/locale")},5914:e=>{e.exports=require("date-fns/startOfMonth")},2659:e=>{e.exports=require("date-fns/startOfWeek")},5358:e=>{e.exports=require("date-fns/subDays")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},3767:e=>{e.exports=import("chart.js")},2189:e=>{e.exports=import("react-chartjs-2")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9796:e=>{e.exports=require("zlib")}};var t=require("../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[761,163,209,450,664,65,946,36,850],()=>__webpack_exec__(5470));module.exports=a})();